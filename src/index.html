<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>MySQL Document Store and Node.JS</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<link rel="stylesheet" href="css/reveal-orcl-override.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-background="images/mysql_bg.jpg" class="mysql-full">MySQL Document Store</section>
				<section>
					<!-- ~5 minutes -->
					<p>Welcome, who are we?</p>
					<table><!-- Yay I'm still a table fan, yes, I'm stuck in HTML 3 :-D -->
						<!-- Stackoveflow uses typical CSS stuff: https://stackoverflow.com/questions/30861845/how-to-use-two-column-layout-with-reveal-js -->
						<tr>
							<td><!-- img src="" --> Johannes Schlüter</td>
							<td><!-- img src="" --> Rui Quelhas</td>
						</tr>
					</table>
					<aside class="notes">
						Also point to MySQLers in audience!
						<ul>
							<li>Geir? - Senior Director of Server Development</li>
							<li>Jan? - DocStore Architect, Server Plugin lead</li>
							<li>LeFred? - Community, InnoDB Cluster expert</li>
							<li>Others!</li>
						</ul>
						All questions could be answered ;-)
					</aside>
				</section>
				<section>
					<!-- Johannes: -->
					<!-- ~5 minutes -->
					<h2>Unstructured Data</h2>
					<section>
						<p>Not only relational data</p>
						<ul>
							<li>Often data of unstructured nature<!-- TODO:Johannes repeating myself from header ....--></li>
							<li>Data from external sources</li>
						</ul>
						<aside class="notes">
							<ul>
								<li>Let's take a look at some samples from OpenStreetmap</li>
							</ul>
						</aside>
					</section>
					<section>
						<pre>
							<code class="js" data-trim data-noescape>
{
  "type": "node",
  "id": 205225934,
  "lat": 53.3809524,
  "lon": -6.2456914,
  "tags": {
    "amenity": "pub",
    "name": "The Viscount"
  }
}
							</code>
						</pre>
						<aside class="notes">
							<ul>
								<li>This is a <i>node</i>, one of the building blocks in OpenStreetmap, a <i>node</i> has an <i>id</i>, geo location and a set of arbitrary tags</li>
								<li>This specific node is a pub and has a name</li>
							</ul>
						</aside>
					</section>
					<section>
						<pre>
							<code class="js" data-trim data-noescape>
{
  "type": "node",
  "id": 130156802,
  "lat": 53.3500620,
  "lon": -6.2526730,
  "tags": {
    "addr:city": "Dublin",
    "addr:country": "IE",
    "addr:housenumber": "21",
    "addr:street": "Store Street",
    "amenity": "pub",
    "name": "Le Monde",
    "wheelchair": "no"
  }
}
							</code>
						</pre>
						<aside class="notes">
							<ul>
								<li>This pub <i>node</i>, contains more data</li>
							</ul>
						</aside>
					</section>
					<section>
						<pre>
							<code class="js" data-trim data-noescape>
{
  "type": "node",
  "id": 132186038,
  "lat": 53.2747643,
  "lon": -6.2545959,
  "tags": {
    "amenity": "pub",
    "name": "The Ballinteer House",
    "wheelchair": "limited"
  }
}
							</code>
						</pre>
					</section>
					<section>
						<pre>
							<code class="js" data-trim data-noescape>
{
  "type": "node",
  "id": 132775981,
  "lat": 53.3441892,
  "lon": -6.2490239,
  "tags": {
    "accommodation": "yes",
    "addr:city": "Dublin",
    "addr:country": "IE",
    "addr:housenumber": "1",
    "addr:street": "Lombard Street East",
    "amenity": "pub",
    "name": "The Lombard",
    "opening_hours": "Mo-Th 09:00-23:30;Fr-Sa 09:30-01:30;Su 10:00-23:00",
    "source": "visually identified"
  }
}
							</code>
						</pre>
						<aside class="notes">
							<p>Last one!</p>
							<p>Other data might of course be way more different</p>
						</aside>
					</section>
					<section>
						<p>JSON data type</p>
						<ul>
							<li>Introduced in MySQL 5.7</li>
							<li>Efficient storage</li>
							<li>Set of functions to create, modify and access elements</li>
							<li>Generated columns allow indexing parts of a document</li>
						</ul>
					</section>
					<section>
						<p>Access using SQL</p>
						<pre>
							<code class="sql" data-trim data-noescape>
							CREATE TABLE collection (doc JSON);
							INSERT INTO collection VALUES ('{ "type":"node" … }');
							<span class="fragment" data-fragment-index="1">
							ALTER TABLE collection ADD COLUMN wheelchair 
							              VARCHAR(255) GENERATED ALWAYS
								      AS (json_unquote(json_extract(doc, '$.tags.wheelchair')))
								      STORED
								      KEY;
							</span><span class="fragment" data-fragment-index="2">
							SELECT * FROM collection WHERE wheelchair != 'no';
							SELECT * FROM collection WHERE json_unquote(doc->'$.tags.wheelchair') != 'no';
							</span>
							</code>
						</pre>
					</section>
				</section>
				<section>
					<!-- Johannes: -->
					<!-- ~2 minutes -->
					<!-- <h2>Interlude with no title</h2> -->
					<section>
						<p>MySQL is a Great Database</p>
						<ul>
							<li>Powerful Features</li>
							<li>InnoDB</li>
							<li>Replication, Group Commit, ...</li>
							<li>Proven and Stable</li>
						</ul>
					</section>
					<section>
						<p>Document Databases</p>
						<ul>
							<li>Simple to setup</li>
							<li>Higher level APIs</li>
						</ul>
					</section>
					<section data-background="images/dolphin-background-grey.png">
						<h3>So, why not combine both!?</h3>
					</section>
				</section>
				<section>
					<!-- Johannes: -->
					<!-- ~3 minutes -->
					<h2>MySQL Document Store</h2>
					<section>
						<p>An X-Over between a relational database and a document database</p>
					</section>
					<section>
						<ul>
							<li>Built upon a new protocol, the X Protocol</li>
							<li>Implementing a common API over multiple languages and environments
								<ul>
									<li>C++, Java, .Net, Node.JS, Python. PHP</li>
									<li>New MySQL Shell</li>
									<li>Easy CRUD operations on relational tables and document database style collections</li>
								</ul>
							</li>
							<li>Based on proven MySQL foundation</li>
						</ul>
						<aside class="notes">
						<p>Learn more about the MySQL Shell tomorrow in LeFred's session on InnoDB Cluster</p>
						</aside>
					</section>
					<section>
						<p>Collections</p>
						<ul>
							<li>An <i>Collection</i> is a set of JSON Documents</li>
							<li>Each document has it's unique ID in an <i>_id</i> property</li>
							<li>Easy to search within documents</li>
							<li>Implemented as a table with a JSON column and indexes on generated columns</li>
						</ul>
					</section>
				</section>
				<section>
					<!-- Johannes: -->
					<!-- ~5 minutes -->
					<h2>X Protocol</h2>
					<section>
						<p>Protocol Insights</p>
						<ul>
							<li>New Protocol implemented in X Plugin</li>
							<li>Based on Google Protocol Buffers
								<ul>
									<li>More flexibility for future extensions</li>
								</ul>
							</li>
							<li>Better understanding of content
								<ul>
								<li>CRUD Expression trees in protocol</li>
								<li>Expectations to attach conditions on pipelined statements</li>
								<li>Bound parameters</li>
								</ul>
							</li>
						</ul>
						<aside class="notes">
							<ul>
								<li>Initially shipped as <i>rapid</i> plugin in MySQL 5.7.12</li>
								<li>Google Protobuf is an industry standard data serialisation library</li>
								<li>Middleware can use more information</li>
							</ul>
						</aside>
					</section>
					<section>
						<p>Protocol operations</p>
						<!-- TODO:Johannes shorten, or not? -->
						<pre><code data-trim data-noescape>
message ClientMessages {
  enum Type {
    CON_CAPABILITIES_GET = 1;
    CON_CAPABILITIES_SET = 2;
    CON_CLOSE = 3;

    SESS_AUTHENTICATE_START = 4;
    SESS_AUTHENTICATE_CONTINUE  = 5;
    SESS_RESET = 6;
    SESS_CLOSE = 7;

    SQL_STMT_EXECUTE = 12;

    CRUD_FIND = 17;
    CRUD_INSERT = 18;
    CRUD_UPDATE = 19;
    CRUD_DELETE = 20;

    EXPECT_OPEN = 24;
    EXPECT_CLOSE = 25;

    CRUD_CREATE_VIEW = 30;
    CRUD_MODIFY_VIEW = 31;
    CRUD_DROP_VIEW = 32;
  }
}
						</code></pre>
					</section>
					<section>
						<p>CRUD Example</p>
						<!-- TODO:Johannes shorten, or not? -->
						<pre><code data-trim data-noescape>
Mysqlx.Crud.Find {
  collection { name: "collection_name",  schema: "test"  }
  data_model: DOCUMENT
  criteria {
    type: OPERATOR
    operator {
      name: "=="
      param { type: IDENT,   identifier { name:"_id" }  }
      param { type: LITERAL, literal { type: V_STRING,
                                       v_string: { value: "some_string" } } }
    }
  }
}
							</code>
						</pre>
					</section>
				</section>
				<section data-external="sections/nodejs.html"></section>
				<section data-external="sections/cnodejs.html"></section>
				<section data-external="sections/snippets.html"></section>
				<section>
					<!-- ~5 minutes -->
					<h2>DEMO</h2>
				</section>
				<section data-external="sections/links.html"></section>
				<section>
					<section>
						<h2>Some related Sessions Tomorrow</h2>
						<ul>
							<li><b>9:15AM</b> State of the Dolphin (Keynote by Geir Høydalsvik)</li>
							<li><b>11:20AM</b> Introduction to MySQL InnoDB Cluster (Frederic Descamps, Jan Kneschke)</li>
							<li><b>4:55PM</b> MySQL Document Store (Frederic Descamps, Jan Kneschke)</li>
						</ul>
					</section>
					<section>
						<h2>Thank You</h2>
					</section>
				</section>
				<section>
					<img src="images/dolphin.jpg" style="border:0px;">
				</section>
				<section>
					<h2>Safe Harbor Statement</h2>
					<p>The preceding is intended to outline our general product direction. It is intended for information purposes only, and may not be incorporated into any contract. It is not a commitment to deliver any material, code, or functionality, and should not be relied upon in making purchasing decisions. The development, release, and timing of any features or functionality described for Oracle’s products remains at the sole discretion of Oracle.</p>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/external/external.js', condition: function() { return !!document.querySelector('[data-external],[data-external-replace]'); } }
				]
			});

			Reveal.configure({
				slideNumber: true
			});
		</script>
	</body>
</html>
